/* @(#) MQMBID sn=mqkoa-L160617.11
 su=_cQX2YDRrEeaZJasCalD_lw
 pn=appmsging/nodejs/mqlight/samples/tonic-example.js
 */
/*
 * <copyright
 * notice="lm-source-program"
 * pids="5725-P60"
 * years="2016"
 * crc="3568777996" >
 * Licensed Materials - Property of IBM
 *
 * 5725-P60
 *
 * (C) Copyright IBM Corp. 2016
 *
 * US Government Users Restricted Rights - Use, duplication or
 * disclosure restricted by GSA ADP Schedule Contract with
 * IBM Corp.
 * </copyright>
 */
var mqlight = require("mqlight")

var client = mqlight.createClient({service: 'amqp://localhost:5672'});

client.on('started', function() {
  client.subscribe('news/technology', function(err, pattern) {
    if (err) {
      console.error('Problem with subscribe request: ', err.message);
    } else {
        console.log('Subscribed to pattern: ', pattern);
        console.log('Sending message : Hello World!');
        client.send('news/technology', 'Hello World!');
    }
  });

  client.on('message', function(data, delivery) {
          console.log('Got message: ', data);
          console.log('Exiting.');
          process.exit(0);
  });
});

